#!/usr/bin/env sh

echo "ğŸ” Running pre-push checks..."

# Run linting, formatting, type checking, unit tests, and build
npm run lint && \
npm run format:check && \
npx tsc --noEmit && \
npm test -- --run && \
npm run build

if [ $? -ne 0 ]; then
  echo "âŒ Pre-push checks failed! Push aborted."
  exit 1
fi

# Run Playwright E2E tests if they exist
if [ -d "e2e" ] && [ -f "playwright.config.ts" ]; then
  echo "ğŸ­ Running Playwright E2E tests..."
  npx playwright test

  if [ $? -ne 0 ]; then
    echo "âŒ E2E tests failed! Push aborted."
    exit 1
  fi
fi

echo "âœ… All pre-push checks passed!"
