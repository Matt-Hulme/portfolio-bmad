# Story 1.7: Project Detail Modal

## Status

**In Progress**

---

## Story

**As a** portfolio visitor,

**I want** to view full project details in a focused modal overlay,

**so that** I can learn more about a project without losing my place in the grid.

---

## Acceptance Criteria

1. Modal opens when project card is clicked
2. Modal uses shadcn Dialog component with proper accessibility
3. Modal displays: full title, full description (markdown support), roles, technologies, links section, media section
4. Links section shows "alive" links and any other project URLs (GitHub, case study, etc.)
5. Media section conditionally hidden when project has no images
6. Media section displays project images in gallery format when present
7. Modal closes on Escape key press
8. Modal closes when clicking backdrop or close button
9. Focus is trapped within modal when open (Tab cycles through modal elements only)
10. Focus returns to clicked card when modal closes
11. Modal is responsive (full screen on mobile, centered overlay on desktop)
12. Smooth open/close animations
13. React Testing Library tests verify modal open/close and keyboard navigation

---

## Tasks / Subtasks

- [ ] **Task 1: Add Dialog Component from shadcn/ui** (AC: 2)
  - [ ] Check if Dialog component already exists
  - [ ] If not, add shadcn Dialog component via CLI
  - [ ] Verify Dialog primitives are installed (@radix-ui/react-dialog)
  - [ ] Test basic Dialog functionality
  - [ ] Review Dialog API and accessibility features

- [ ] **Task 2: Install react-markdown** (AC: 3)
  - [ ] Install react-markdown package
  - [ ] Install remark-gfm for GitHub Flavored Markdown support
  - [ ] Test markdown rendering with sample content
  - [ ] Style markdown content to match design system
  - [ ] Configure markdown component options

- [ ] **Task 3: Create ProjectDetailModal Component** (AC: 1, 3, 4, 5, 6, 11, 12)
  - [ ] Create `src/components/projects/ProjectDetailModal.tsx` file
  - [ ] Accept props: project, isOpen, onClose
  - [ ] Use shadcn Dialog with DialogContent, DialogHeader, etc.
  - [ ] Render project title in DialogTitle
  - [ ] Render full description using react-markdown
  - [ ] Display roles as badges (similar to card)
  - [ ] Display technologies as badges or list
  - [ ] Create Links section component
  - [ ] Display links with icons and proper styling
  - [ ] Create Media section component
  - [ ] Conditionally render Media section only if images exist
  - [ ] Display images in gallery format (grid or carousel)
  - [ ] Make modal responsive (full screen mobile, centered desktop)
  - [ ] Ensure smooth animations using Dialog's built-in transitions
  - [ ] Add proper spacing and typography

- [ ] **Task 4: Add Modal State Management to Home Page** (AC: 1, 7, 8, 10)
  - [ ] Add state for modal open/close in Home.tsx
  - [ ] Add state for selected project
  - [ ] Create handleProjectClick function to open modal with project
  - [ ] Create handleCloseModal function to close modal and clear selection
  - [ ] Pass onProjectClick handler to ProjectGrid
  - [ ] Render ProjectDetailModal with state
  - [ ] Verify modal opens when card clicked
  - [ ] Verify modal closes on Escape key (built-in Dialog behavior)
  - [ ] Verify modal closes on backdrop click (built-in Dialog behavior)
  - [ ] Verify focus returns to card after close

- [ ] **Task 5: Style and Polish Modal** (AC: 3, 11, 12)
  - [ ] Style markdown content (headings, lists, code blocks, etc.)
  - [ ] Add custom CSS for markdown if needed
  - [ ] Ensure links section is visually distinct
  - [ ] Ensure media gallery is attractive and functional
  - [ ] Test responsive behavior (mobile/tablet/desktop)
  - [ ] Verify animations are smooth
  - [ ] Check scroll behavior for long content
  - [ ] Add loading state if needed
  - [ ] Ensure consistent spacing throughout modal

- [ ] **Task 6: Accessibility Testing** (AC: 2, 7, 8, 9, 10)
  - [ ] Verify focus trap works (Tab cycles within modal)
  - [ ] Verify Escape key closes modal
  - [ ] Verify backdrop click closes modal
  - [ ] Verify close button works
  - [ ] Verify focus returns to trigger element after close
  - [ ] Test with keyboard only (no mouse)
  - [ ] Test with screen reader if possible
  - [ ] Verify ARIA labels are correct
  - [ ] Check color contrast

- [ ] **Task 7: Unit Testing** (AC: 13)
  - [ ] Create `src/components/projects/ProjectDetailModal.test.tsx` file
  - [ ] Test modal renders when open
  - [ ] Test modal does not render when closed
  - [ ] Test modal displays all project data correctly
  - [ ] Test modal displays links section
  - [ ] Test modal hides media section when no images
  - [ ] Test modal shows media section when images present
  - [ ] Test close button calls onClose
  - [ ] Test Escape key closes modal (if testable)
  - [ ] Test markdown rendering
  - [ ] Test responsive rendering (if testable)
  - [ ] All tests passing

- [ ] **Task 8: End-to-End Testing** (AC: all)
  - [ ] Click project card → modal opens
  - [ ] Verify all project data displayed
  - [ ] Verify markdown renders correctly
  - [ ] Verify links are clickable
  - [ ] Verify images display (for projects with images)
  - [ ] Close modal with X button → modal closes
  - [ ] Open modal again, close with Escape → modal closes
  - [ ] Open modal, close with backdrop click → modal closes
  - [ ] Verify focus returns after close
  - [ ] Test on mobile viewport
  - [ ] Test on tablet viewport
  - [ ] Test on desktop viewport
  - [ ] Test with long content (scrolling)

---

## Dev Notes

### Architecture Context

**Modal vs Sheet** [Source: Epic 1]
- Dialog (centered modal) preferred over Sheet (side panel)
- Dialog provides focused reading experience
- Better for content-heavy detail views
- Sheet already exists in codebase (could be alternative approach)

**Markdown Rendering** [Source: AC 3]
- Project descriptions stored as markdown strings
- react-markdown library for rendering
- Supports headings, lists, links, code blocks, etc.
- Need to style markdown to match design system
- Consider syntax highlighting for code blocks (optional)

**Media Gallery Design** [Source: AC 5-6]
- Simple grid layout acceptable
- Could use carousel for better UX (optional)
- Lightbox for full-size images (future enhancement)
- Lazy loading for images (optional optimization)

### Component Architecture

```typescript
// ProjectDetailModal.tsx
interface ProjectDetailModalProps {
  project: Project | null;
  isOpen: boolean;
  onClose: () => void;
}

export function ProjectDetailModal({ project, isOpen, onClose }: ProjectDetailModalProps) {
  if (!project) return null;

  return (
    <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>
      <DialogContent className="max-w-3xl max-h-[90vh] overflow-y-auto">
        <DialogHeader>
          <DialogTitle>{project.title}</DialogTitle>
        </DialogHeader>

        {/* Description with markdown */}
        <ReactMarkdown>{project.description}</ReactMarkdown>

        {/* Roles and Technologies */}
        <div>
          <h3>Roles</h3>
          {project.roles.map(role => <Badge key={role}>{role}</Badge>)}
        </div>

        {/* Links Section */}
        {project.links && project.links.length > 0 && (
          <LinksSection links={project.links} />
        )}

        {/* Media Section */}
        {project.images && project.images.length > 0 && (
          <MediaSection images={project.images} />
        )}
      </DialogContent>
    </Dialog>
  );
}
```

### Home Page Integration

```typescript
// Home.tsx
export function Home() {
  const [selectedProject, setSelectedProject] = useState<Project | null>(null);
  const [isModalOpen, setIsModalOpen] = useState(false);

  // ... existing filter logic

  const handleProjectClick = (project: Project) => {
    setSelectedProject(project);
    setIsModalOpen(true);
  };

  const handleCloseModal = () => {
    setIsModalOpen(false);
    // Optional: slight delay before clearing project
    setTimeout(() => setSelectedProject(null), 200);
  };

  return (
    <div>
      {/* ... existing content */}

      <ProjectGrid
        projects={filteredProjects}
        onProjectClick={handleProjectClick}
      />

      <ProjectDetailModal
        project={selectedProject}
        isOpen={isModalOpen}
        onClose={handleCloseModal}
      />
    </div>
  );
}
```

### Visual Design Details

**Modal Layout:**
- Max width: 3xl (768px)
- Max height: 90vh with scroll
- Padding: Consistent spacing
- White/light background (contrast with dark backdrop)
- Rounded corners

**Content Sections:**
1. Header: Title + Close button
2. Description: Markdown content
3. Metadata: Roles and Technologies badges
4. Links: List with icons
5. Media: Image gallery grid

**Markdown Styling:**
- Headings: Scale from h1-h6
- Lists: Proper indentation and bullets
- Links: Primary color, underline on hover
- Code: Monospace font, background
- Paragraphs: Readable line height

**Media Gallery:**
- 2-column grid on mobile
- 3-column grid on tablet+
- Image aspect ratio maintained
- Caption below each image
- Subtle border or shadow

**Responsive Behavior:**
- Mobile: Full screen modal, scroll content
- Tablet: 80% width, centered, scroll content
- Desktop: Max 768px width, centered, scroll content

### Accessibility Features

**Dialog Primitives (Radix UI):**
- Focus trap automatic
- Escape key handling automatic
- Backdrop click handling automatic
- Focus return automatic
- ARIA attributes automatic

**Additional Considerations:**
- Descriptive DialogTitle for screen readers
- Alt text on all images (already in data)
- Keyboard navigable links
- Sufficient color contrast
- Visible focus indicators

### Testing Strategy

**Unit Tests:**
- Component renders correctly with project data
- Conditional rendering (links, images)
- Event handlers (onClose)
- Markdown rendering

**Integration Tests:**
- Full user flow: Click card → View modal → Close modal
- Multiple open/close cycles
- Focus management

**Accessibility Tests:**
- Keyboard navigation
- Focus trap
- Screen reader compatibility (manual)
- ARIA attributes present

**Responsive Tests:**
- Mobile rendering
- Tablet rendering
- Desktop rendering
- Scroll behavior with long content

### Performance Considerations

**Lazy Loading:**
- Images can be lazy loaded
- Consider IntersectionObserver for gallery
- Defer for initial implementation

**Animation Performance:**
- Use CSS transforms for smooth animations
- Dialog component handles this by default
- Monitor for jank on mobile

**Bundle Size:**
- react-markdown adds ~50KB
- Acceptable for this use case
- Consider lazy loading modal component (future)

### Dependencies

**New Dependencies:**
- `react-markdown` - Markdown rendering
- `remark-gfm` - GitHub Flavored Markdown support
- `@radix-ui/react-dialog` - Dialog primitives (may already be installed via shadcn Sheet)

**shadcn Components:**
- Dialog (to be added)
- Badge (already exists)
- Button (already exists)

### Coding Standards [Source: architecture.md#16.1]

**React:**
- Functional components
- Named exports
- TypeScript interfaces for all props
- Proper hooks usage (useState)

**Styling:**
- Tailwind utility classes
- Responsive design
- Consistent spacing
- Design system colors

**Accessibility:**
- Use semantic HTML
- Proper ARIA labels
- Keyboard support
- Focus management

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-10 | 1.0 | Initial story document created | Dev Agent (Claude) |

---

## Dev Agent Record

### Agent Model Used

claude-sonnet-4-5-20250929

### Debug Log References

_To be filled during implementation_

### Completion Notes List

_To be filled as tasks are completed_

### File List

**To Be Created:**
- `frontend/src/components/projects/ProjectDetailModal.tsx` - Main modal component
- `frontend/src/components/projects/ProjectDetailModal.test.tsx` - Unit tests
- `frontend/src/components/ui/dialog.tsx` - shadcn Dialog component (if not exists)

**To Be Modified:**
- `frontend/src/pages/Home.tsx` - Add modal state and handlers
- `frontend/package.json` - Add react-markdown dependencies

**Commits:**
- _To be added during implementation_

---

## QA Results

_To be filled after implementation and testing_
